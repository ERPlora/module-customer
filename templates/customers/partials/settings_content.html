{% load static i18n ui component_tags %}

{% component "page"
    title=_("Customer Settings")
    subtitle=_("Configure customers module behavior")
    module_id="customers"
    tabbar_view="settings" %}

    {% fill "content" %}
        {% csrf_token %}

        <!-- Required Fields Section -->
        <ion-card class="m-0 mb-4">
            <ion-card-header>
                <ion-card-title>{% trans "Required Fields" %}</ion-card-title>
            </ion-card-header>
            <ion-card-content class="p-0">
                <ion-list>
                    <ion-item>
                        {% component "toggle"
                            name="require_phone"
                            checked=config.require_phone
                            color="warning"
                            title=_("Require Phone")
                            description=_("Phone number is mandatory when creating customers")
                            hx_post=customers_toggle_url %}
                        {% endcomponent %}
                    </ion-item>
                    <ion-item>
                        {% component "toggle"
                            name="require_email"
                            checked=config.require_email
                            color="warning"
                            title=_("Require Email")
                            description=_("Email is mandatory when creating customers")
                            hx_post=customers_toggle_url %}
                        {% endcomponent %}
                    </ion-item>
                    <ion-item>
                        {% component "toggle"
                            name="require_tax_id"
                            checked=config.require_tax_id
                            color="warning"
                            title=_("Require Tax ID")
                            description=_("Tax ID (ID/VAT number) is mandatory when creating customers")
                            hx_post=customers_toggle_url %}
                        {% endcomponent %}
                    </ion-item>
                </ion-list>
            </ion-card-content>
        </ion-card>

        <!-- Display Options Section -->
        <ion-card class="m-0 mb-4">
            <ion-card-header>
                <ion-card-title>{% trans "Display Options" %}</ion-card-title>
            </ion-card-header>
            <ion-card-content class="p-0">
                <ion-list>
                    <ion-item>
                        {% component "toggle"
                            name="show_inactive"
                            checked=config.show_inactive
                            title=_("Show Inactive Customers")
                            description=_("Include inactive customers in the list by default")
                            hx_post=customers_toggle_url %}
                        {% endcomponent %}
                    </ion-item>
                    <ion-item>
                        {% component "select_field"
                            name="default_sort"
                            value=config.default_sort
                            options=sort_options
                            label=_("Default Sort Order")
                            hx_post=customers_select_url %}
                        {% endcomponent %}
                    </ion-item>
                </ion-list>
            </ion-card-content>
        </ion-card>

        <!-- Export Options Section -->
        <ion-card class="m-0 mb-4">
            <ion-card-header>
                <ion-card-title>{% trans "Export Options" %}</ion-card-title>
            </ion-card-header>
            <ion-card-content class="p-0">
                <ion-list>
                    <ion-item>
                        {% component "toggle"
                            name="include_stats_in_export"
                            checked=config.include_stats_in_export
                            title=_("Include Stats in Export")
                            description=_("Include spending statistics when exporting customers to CSV")
                            hx_post=customers_toggle_url %}
                        {% endcomponent %}
                    </ion-item>
                </ion-list>
            </ion-card-content>
        </ion-card>

        <!-- Reset Button -->
        <div class="mt-lg pt-md" style="border-top: 1px solid var(--border-color);">
            <ion-button
                color="medium"
                fill="outline"
                expand="block"
                hx-post="{% url 'customers:settings_reset' %}"
                hx-include="[name='csrfmiddlewaretoken']"
                hx-swap="none"
                hx-confirm="{% trans 'Reset all settings to defaults?' %}">
                <ion-icon slot="start" name="refresh-outline"></ion-icon>
                {% trans "Reset to Defaults" %}
            </ion-button>
        </div>
    {% endfill %}
{% endcomponent %}
